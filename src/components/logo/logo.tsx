/** @jsx jsx */
import { FunctionComponent, useEffect, useState } from 'react'
import { jsx, Box } from 'theme-ui'
import { useSpring, animated } from 'react-spring'
import { fromUnixTime, format } from 'date-fns'

import { IContextProps } from '../../types'

interface ICountdownProps {
  duration: number
}

const Countdown: FunctionComponent<ICountdownProps> = ({ duration }) => {
  const { number } = useSpring({
    from: { number: duration },
    number: 0,
    config: { duration: duration },
  })

  return (
    <animated.text transform="matrix(1 0 0 1 404 378)">
      {number.to((n) => `${Math.round(n)}s`)}
    </animated.text>
  )
}

interface ILogoProps extends IContextProps {}

export const Logo: FunctionComponent<ILogoProps> = ({ issNow }) => {
  const { timestamp, latitude, longitude } = issNow

  const [trigger, setTrigger] = useState(0)

  useEffect(() => {
    setTrigger(issNow ? issNow.timestamp : 1)
  }, [issNow])

  return (
    <Box
      sx={{
        mb: 4,
        width: '100%',
      }}
    >
      <svg
        version="1.1"
        id="Layer_1"
        xmlns="http://www.w3.org/2000/svg"
        x="0px"
        y="0px"
        width="100%"
        height="100%"
        viewBox="0 0 900 600"
        sx={{
          text: {
            fontFamily: 'body',
            fontSize: 5,
          },
        }}
      >
        <g id="Layer_1_1_">
          <path
            fill="#FCD222"
            d="M64,279.4c25.2,23.1,57.9,38.2,93.9,41.3v-42.2C99.5,271.6,54,221.9,54,161.7s45.5-110,103.9-116.9V2.6
		c-36,3.1-68.7,18.2-93.9,41.3L34.7,14.7c-5.2-5.2-13.7-5.2-18.9,0l-9,9c-5.2,5.2-5.2,13.7,0,18.9l31.5,31.5
		C21.7,99.3,12,129.4,12,161.8s9.7,62.5,26.3,87.7L6.9,280.8c-5.2,5.2-5.2,13.7,0,18.9l8.9,8.9c5.2,5.2,13.7,5.2,18.9,0L64,279.4z"
          />
          <path
            fill="none"
            d="M402.8,146.3c-4.2-3.7-9.5-5.5-15.8-5.5c-6.8,0-12.1,1.9-15.9,5.8c-3.8,3.9-6.1,9.1-7.1,15.7h45.8
		C409.4,155.3,407.1,150,402.8,146.3z"
          />
          <path
            fill="none"
            d="M556.6,146.3c-4.2-3.7-9.5-5.5-15.8-5.5c-6.8,0-12.1,1.9-15.9,5.8c-3.8,3.9-6.1,9.1-7.1,15.7h45.8
		C563.2,155.3,560.9,150,556.6,146.3z"
          />
          <polygon
            points="196.7,194.8 181.2,121.6 154.2,121.6 139.6,194.6 123.7,121.6 95.2,121.6 123.7,223.3 151.3,223.3 167.5,149.2 
		183.4,223.3 210.7,223.3 240.2,121.6 212.5,121.6 	"
          />
          <path
            d="M327.1,132.2c-3.3-4.5-7.5-7.8-12.6-10s-10.8-3.3-17-3.3c-5.6,0-10.9,1.2-15.9,3.5s-9.5,6.4-13.3,12.4V86.3h-26.6v137h26.6
		v-55.1c0-8.7,1.8-15.4,5.4-20.1c3.6-4.7,8.9-7,15.9-7c6.7,0,11.3,2.4,13.7,7.1c1.8,3.4,2.8,7.8,2.8,13.3v61.9h27.1v-59.7
		c0-9.1-0.3-15.6-0.9-19.6S329.9,136,327.1,132.2z"
          />
          <path
            d="M436.6,159.7c-1.2-8-3.9-15-8.1-21c-4.6-6.8-10.5-11.9-17.6-15c-7.1-3.2-15.1-4.8-23.9-4.8c-14.9,0-27,4.7-36.3,14.1
		c-9.3,9.4-14,22.9-14,40.5c0,18.8,5.2,32.4,15.5,40.7s22.3,12.5,35.8,12.5c16.4,0,29.1-4.9,38.2-14.8c5.9-6.2,9.1-12.3,9.9-18.4
		H409c-1.6,3-3.4,5.3-5.5,7c-3.8,3.1-8.7,4.7-14.8,4.7c-5.7,0-10.6-1.3-14.7-3.8c-6.7-4.1-10.2-11.3-10.6-21.4h73.8v-13.3
		C437.2,164,436.9,161.7,436.6,159.7z M364.1,162.4c1-6.6,3.3-11.9,7.1-15.7c3.8-3.9,9-5.8,15.9-5.8c6.3,0,11.5,1.8,15.8,5.5
		c4.2,3.7,6.6,9,7.1,16.1h-45.9V162.4z"
          />
          <path
            d="M496.3,119.4c-1.2-0.1-1.9-0.1-2.3-0.1c-0.3,0-0.8,0-1.3,0c-8,0-14.4,2.1-19.4,6.2c-3,2.5-6.6,7.1-10.7,13.9v-17.7h-25.4
		v45V180v43.4H464v-48.6c0-8.1,1-14.2,3.1-18.1c3.7-7,10.8-10.4,21.5-10.4c0.8,0,1.9,0,3.2,0.1c1.1,0.1,2.3,0.2,3.6,0.3
		c0.3-0.6,0.5-1.3,0.8-1.9L496.3,119.4L496.3,119.4z"
          />
          <path
            d="M590.4,159.7c-1.2-8-3.9-15-8.1-21c-4.6-6.8-10.5-11.9-17.6-15s-15.1-4.8-23.9-4.8c-14.9,0-27,4.7-36.3,14.1
		c-3.3,3.4-6,7.3-8.2,11.7c-0.3,0.6-0.6,1.2-0.8,1.9c-3.3,7.6-5,16.5-5,27c0,18.8,5.2,32.4,15.5,40.7c10.3,8.3,22.3,12.5,35.8,12.5
		c16.4,0,29.1-4.9,38.2-14.8c5.9-6.2,9.1-12.3,9.9-18.4h-27.1c-1.6,3-3.4,5.3-5.5,7c-3.8,3.1-8.7,4.7-14.8,4.7
		c-5.7,0-10.6-1.3-14.7-3.8c-6.7-4.1-10.2-11.3-10.6-21.4h74C591.4,171.1,591.1,164.4,590.4,159.7z M517.9,162.4
		c1-6.6,3.3-11.9,7.1-15.7c3.8-3.9,9-5.8,15.9-5.8c6.3,0,11.5,1.8,15.8,5.5c4.2,3.7,6.6,9,7.1,16.1h-45.9V162.4z"
          />
          <rect x="273.7" y="235.8" width="26.9" height="101.6" />
          <path
            d="M391.8,287.5c-5.3-5-13.2-8.8-23.8-11.3c-15.9-3.5-25.1-5.9-27.7-7.4c-2.6-1.4-3.9-3.6-3.9-6.6c0-2.4,1.2-4.5,3.7-6.3
		s6.6-2.7,12.4-2.7c7,0,12,1.8,15,5.4c1.6,2,2.5,4.7,2.9,8.1H397c-1.2-12.4-5.8-21.2-13.8-26.2c-8-5.1-18.4-7.6-31.1-7.6
		c-13.4,0-23.8,3.4-31.2,10.1c-7.4,6.7-11.1,14.8-11.1,24.2c0,8,2.4,14,7.1,18.3s12.9,7.9,24.4,10.7c16,3.8,25.3,6.5,27.8,8
		c2.5,1.6,3.7,3.8,3.7,6.8c0,3.1-1.5,5.4-4.6,7s-7.3,2.3-12.5,2.3c-8.9,0-15.1-1.8-18.4-5.3c-1.9-2-3.1-5.3-3.7-10.1h-26.9
		c0,10.4,3.8,19,11.4,25.8c7.6,6.7,19.4,10.1,35.5,10.1c15.7,0,27.3-3.2,34.8-9.6s11.3-14.6,11.3-24.7
		C399.7,299,397.1,292.6,391.8,287.5z"
          />
          <rect x="273.4" y="354" fill="#F431EA" width="125.9" height="26.1" />
          <path
            fill="#F431EA"
            d="M335.9,479.5c3.8-4.8,6.9-12.1,9.1-21.8l5.2-22.1c2-8.5,3.7-14.1,5.2-16.7c2.2-4.1,5.6-6.1,10.1-6.1
		c4.9,0,8.7,2.1,11.4,6.2c2.7,4.1,4.1,9.7,4.1,16.6c0,6.2-1.1,11.5-3.2,15.7c-3.2,6.3-8.6,9.7-16.1,10.2v25.3
		c13.4-0.5,23.6-5.4,30.6-14.9s10.6-20.9,10.6-34.4c0-16.1-3.7-28.3-11.2-36.6c-7.5-8.3-16.8-12.5-28.1-12.5
		c-12.4,0-21.4,4.2-27.3,12.7c-3.5,5-6.7,14.2-9.7,27.6l-3,13.6c-1.7,8-3.7,13.8-5.9,17.5c-2.3,3.7-5.5,5.5-9.7,5.5
		c-7.1,0-12-3.8-14.6-11.3c-1.4-4-2.1-9.1-2.1-15.4c0-10.6,2.6-18.1,7.8-22.4c2.8-2.4,7.1-4,12.9-4.8v-25.1
		c-13.1,0-23.4,4.7-30.9,14.2s-11.2,22.5-11.2,39.1c0,16.2,3.8,28.8,11.4,37.7c7.6,8.9,17.2,13.3,28.7,13.3
		C321.4,490.7,330,487,335.9,479.5z"
          />
          <path
            fill="#F431EA"
            d="M335.9,583.9c3.8-4.8,6.9-12.1,9.1-21.8l5.2-22.1c2-8.5,3.7-14.1,5.2-16.7c2.2-4.1,5.6-6.1,10.1-6.1
		c4.9,0,8.7,2.1,11.4,6.2c2.7,4.1,4.1,9.7,4.1,16.6c0,6.2-1.1,11.5-3.2,15.7c-3.2,6.3-8.6,9.7-16.1,10.2v25.3
		c13.4-0.5,23.6-5.4,30.6-14.9s10.6-20.9,10.6-34.4c0-16.1-3.7-28.3-11.2-36.6c-7.5-8.3-16.8-12.5-28.1-12.5
		c-12.4,0-21.4,4.2-27.3,12.7c-3.5,5-6.7,14.2-9.7,27.6l-3,13.6c-1.7,8-3.7,13.8-5.9,17.5c-2.3,3.7-5.5,5.5-9.7,5.5
		c-7.1,0-12-3.8-14.6-11.3c-1.4-4-2.1-9.1-2.1-15.4c0-10.6,2.6-18.1,7.8-22.4c2.8-2.4,7.1-4,12.9-4.8v-25.1
		c-13.1,0-23.4,4.7-30.9,14.2c-7.5,9.5-11.2,22.5-11.2,39.1c0,16.2,3.8,28.8,11.4,37.7S298.5,595,310,595
		C321.4,595.2,330,591.4,335.9,583.9z"
          />
          <path
            fill="#F431EA"
            d="M272,208.6c0.1-19.9,30.3-19.9,30.4,0C302.3,228.5,272.1,228.5,272,208.6z"
          />
          <text transform="matrix(1 0 0 1 404 265)">lattitude: </text>
          <text transform="matrix(1 0 0 1 550 265)">{latitude}</text>
          <text transform="matrix(1 0 0 1 404 297)">longitude: </text>
          <text transform="matrix(1 0 0 1 550 297)">{longitude}</text>
          <text transform="matrix(1 0 0 1 404 332)">
            {format(fromUnixTime(timestamp), "dd-MMM-yyyy '|' hh:mm:ss")}
          </text>
          <Countdown key={`${trigger}-countdown`} duration={5000} />
          <g>
            <g>
              <defs>
                <path
                  id="SVGID_1_"
                  d="M590.9,102.6c-105.9,0-316.6,0-316.6,0v-22h-39.7v34h-66.3v-67H591L590.9,102.6L590.9,102.6z"
                />
              </defs>
            </g>
          </g>
        </g>
      </svg>
    </Box>
  )
}
